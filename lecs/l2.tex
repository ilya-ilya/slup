\chapter{Ветвящиеся процессы и процессы восстановления}

\section{Модель Гальтона\DВатсона}\index{Модель Гальтона-Ватсона}

\paragraph{Описание модели.}

Пусть $\hc{ \xi, \xi_{n, k} \mid n, k \in \N}$ \td массив независимых одинаково распределенных случайных величин,
\[
	\Pf (\xi = m) = p_m \ge 0, \; m \in \Z_{+} = \hc{0, 1, 2\etc}.
\]
Такие существуют в силу теоремы Ломницкого--Улама.
Положим
\begin{align*}
	Z_0(\omega) &\deq 1,\\
	Z_n(\omega) &\deq \sum_{k = 1}^{Z_{n - 1}(\omega)} \xi_{n, k}(\omega) \quad \text{для $n \in \N$}.
\end{align*}
Здесь подразумевается, что если $Z_{n-1}(\omega) = 0$, то и вся сумма равна нулю.
Таким образом, рассматривается сумма случайного числа случайных величин.
Определим
$A = \hc{\omega \mid \Ex n = n(\omega): Z_{n}(\omega) = 0}$ \td \index{Вырождение}\textit{событие вырождения популяции}.
Заметим, что если $Z_n(\omega) = 0$, то $Z_{n+1}(\omega) = 0$.
Таким образом,
$\hc{ Z_n = 0} \subs \hc{ Z_{n+1} = 0}$ и $A = \cupnui \hc{ Z_{n} = 0}$.

По свойству непрерывности вероятностной меры,
\[
	\Pf(A) = \lim_{n \to \bes} \Pf(Z_n = 0).
\]

\begin{df}\index{Производящая функция}
	Пусть дана последовательность $(a_n)_{n=0}^{\bes}$ неотрицательных чисел такая,
	что $\sumnzi a_n = 1$.
	\textit{Производящая функция} для этой последовательности \td это
	\[
		f(s) \deq \sumkzi s^k a_k, \quad |s| \le 1
	\]
	(нас в основном будут интересовать $s \in [0, 1]$).
\end{df}

Заметим, что если $a_k = \Pf(Y = k), k = 0, 1,\; \ldots$ , то
\[
	f_Y(s) = \sumkzi s^k \Pf(Y = k) = \Ef s^Y, \quad s \in [0, 1].
\]

\begin{lemma}
	\label{lem1}
	Вероятность $\Pf(A)$ является корнем уравнения $\psi(p) = p$, где $\psi = f_{\xi}$ и $p \in [0, 1]$.
\end{lemma}

\begin{proof}
	\begin{multline*}
		f_{Z_n}(s)
	=	\Ef s^{Z_n}
	=	\Ef \hr{s^{\sum_{k = 1}^{Z_{n - 1}} \xi_{n, k}}} = \\
	=	\sumjzi \Ef \hs{ \hr{ s^{\sum_{k = 1}^{Z_{n - 1}} \xi_{n, k}} } \Ibb \hc{ Z_{n - 1} = j}} = \\
	=	\sumjzi \Ef \hs{ \hr{ s^{\sum_{k = 1}^j \xi_{n, k}} } \Ibb \hc{ Z_{n - 1} = j} }.
	\end{multline*}
	Поскольку $\sigma \hc{ Z_r} \subs \sigma \hc{ \xi_{m, k}, \; m = 1 \sco r,\; k \in \N}$,
	которая независима с $\sigma \hc{\xi_{n, k}, \; k \in \N}$
	(строгое и полное обоснование остается в качестве упражнения), то
	\begin{multline*}
		\sumjzi \Ef \hs{ \hc{ s^{\sum_{k = 1}^j \xi_{n, k}} } \Ibb \hc{ Z_{n-1} = j } }
	=	\sumjzi \Ef \hr{s^{\sum_{k = 1}^j \xi_{n, k}}} \Ef \Ibb \hc{ Z_{n - 1} = j} = \\
	=	\sumjzi \Ef \hr{s^{\sum_{k=1}^j \xi_{n, k}}} \Pf ( Z_{n - 1} = j )
	=	\sumjzi \prod_{k = 1}^j \Ef s^{\xi_{n, k}} \Pf (Z_{n - 1} = j) = \\
	=	\sumjzi \psi_{\xi}^j (s) \Pf (Z_{n - 1} = j)
	=	f_{Z_{n - 1}} \hr{\psi_{\xi} (s)}
	\end{multline*}
	в силу независимости и одинаковой распределенности $\xi_{n, k}$ и определения производящей функции.
	Таким образом,
	\[
		f_{Z_n} (s) = f_{Z_{n - 1}} \hr{ \psi_{\xi} (s)}, \quad s \in [0, 1]{.}
	\]
	Подставим $s = 0$ и получим, что
	\[
		f_{Z_n} (0) = f_{Z_{n - 1}} \hr{ \psi_{\xi} (0)}
	\]
	Заметим, что
	\[
		f_{Z_n}(s)
	=	f_{Z_{n - 1}}(\psi_{\xi}(s))
	=	f_{Z_{n - 2}} \hr{\psi_{\xi} \hr{ \psi_{\xi} (s) } }
	=	\ldots
	=	\ub{\psi_{\xi} (\psi_{\xi} \ldots (\psi_{\xi}(s)) \ldots ) }_{\text{$n$ итераций}}
	=	\psi_{\xi} (f_{Z_{n - 1}} (s)).
	\]
	Тогда при $s = 0$ имеем, что
	\[
		\Pf (Z_n = 0) = \psi_{\xi} \hr{ \Pf\hr{Z_{n - 1} = 0}}.
	\]
	Но $\Pf(Z_n = 0) \upto \Pf(A)$ при $n \to \bes$ и $\psi_{\xi}$ непрерывна на $[0, 1]$.
	Переходим к пределу при $n \to \bes$.
	Тогда
	\[
		\Pf(A) = \psi_{\xi} (\Pf(A)),
	\]
	то есть $\Pf(A)$ \td корень уравнения $p = \psi_{\xi}(p)$, $p \in [0, 1]$.
\end{proof}

\begin{theorem}
	Вероятность $p$ вырождения процесса Гальтона\DВатсона есть \textbf{наименьший} корень уравнения
	\begin{equation}
		\label{eq1}
		\psi(p) = p, \quad p \in [0, 1],
	\end{equation}
	где $\psi = \psi_{\xi}$.
\end{theorem}

\begin{proof}
	Пусть $p_0 \deq \Pf(\xi = 0) = 0$.
	Тогда
	\[
		\Pf(\xi \ge 1) = 1, \quad \Pf\hr{\caps{n,k} \hc{ \xi_{n,k} \ge 1} } = 1.
	\]
	Поэтому $Z_n \ge 1$ при $\fA n$, то есть $\Pf(A)$ \td наименьший корень уравнения~\eqref{eq1}.

	Пусть теперь $p_0 = 1$.
	Тогда $\Pf(\xi = 0)=1 \Ra \Pf(A)$ \td наименьший корень уравнения~\eqref{eq1}.

	Пусть, наконец, $0 < p_{0} < 1$.
	Из этого следует, что $\Ex m\in\N:\; p_m > 0$, а значит, $\psi$ строго возрастает на $[0, 1]$.
	Рассмотрим
	\[
		\Delta_n = \hsr{\psi_{n}(0), \psi_{n + 1}(0)},\quad n = 0, 1, 2 \etc ,
	\]
	где $\psi_n(s)$ \td это производящая функция $Z_n$.

	Пусть $s \in \Delta_n$.
	Тогда из монотонности $\psi$ на $[0, 1]$ получаем, что
	\[
		\psi(s) - s > \psi(\psi_n(0)) - \psi_{n + 1}(0)  =  \psi_{n + 1}(0) - \psi_{n + 1}(0) = 0,
	\]
	что означает, что у уравнения~\eqref{eq1} нет корней на $\Delta_n \; \fA n \in \Z_{+}$.
	Заметим, что
	\[
		\cupnzi \Delta_n = \hsr{0, \Pf(A)}, \quad \psi_n(0) \upto \Pf(A).
	\]
	По лемме \ref{lem1} $\Pf(A)$ является корнем уравнения \eqref{eq1}.
	Следовательно, показано, что $\Pf(A)$ \td наименьший корень, что и требовалось доказать.
\end{proof}

\begin{theorem}
	\begin{points}{0}
		\item\label{firth} Вероятность вырождения $\Pf(A)$ есть нуль $\Lra$ $p_{0} = 0$.
		\item\label{secth} Пусть $p_{0} > 0$.
			Тогда при $\Ef \xi \le 1$ имеем $\Pf (A) = 1$,
			при $\Ef \xi > 1$ имеем $\Pf(A) < 1$.
	\end{points}
\end{theorem}

\begin{proof}
	Докажем \autoref{firth}.
	Пусть $\Pf(A) = 0$.
	Тогда $p_{0} = 0$, потому что иначе была бы ненулевая вероятность вымирания $\Pf(A) > \Pf(Z_1 = 0) = p_0$.
	В другую сторону, если $p_0 = 0$, то вымирания не происходит (почти наверное) из-за того,
	что у каждой частицы есть как минимум один потомок (почти наверное).

	Докажем \autoref{secth}.
	Пусть $\mu = \Ef\xi \le 1$.
	Покажем, что в таком случае у уравнения \eqref{eq1} будет единственный корень, равный $1$.
	\[
		\psi_{\xi}^{\prime} (z)
	=	\sumkui kz^{k - 1}\Pf(\xi = k) \Ra \psi_{\xi}^{\prime} (z) > 0, \quad \text{ при $z > 0$,}
	\]
	если только $\xi$ не тождественно равна нулю (в противном случае утверждение теоремы выполнено).
	Заметим также, что $\psi_{\xi}^{\prime} (z)$ возрастает на $z > 0$.
	Воспользуемся формулой Лагранжа:
	\[
		1 - \psi_{\xi} (z)
	=	\psi_{\xi} (1) - \psi_{\xi} (z)
	=	\psi_{\xi}^{\prime} (\theta) (1 - z)
	<	\psi_{\xi}^{\prime} (1) (1-z) \le 1 - z,
	\]
	где $z \in (0, 1)$, в силу монотонности $\psi_{\xi}^{\prime} (z)$.
	Следовательно, если $z < 1$, то
	\[
		1 - \psi_{\xi}(z) < 1 - z,
	\]
	то есть $z = 1$ \td это единственный корень уравнения \eqref{eq1}.
	Значит, $P(A) = 1$.

	Пусть $\mu = \Ef\xi > 1$.
	Покажем, что в таком случае у уравнения \eqref{eq1} есть два корня, один из которых строго меньше единицы.
	\[
		\psi_{\xi}^{\prime\prime}(z)
	=	\sum\limits_{k=2}^{\bes} k (k - 1) z^{k - 2} \Pf(\xi = k),
	\]
	следовательно, $\psi_{\xi}^{\prime\prime}(z)$ монотонно возрастает и больше нуля при $z > 0$.
	Из этого следует, что $1 - \psi_{\xi}^{\prime} (z)$ строго убывает, причем
	\begin{align*}
		& 1 - \psi_{\xi}^{\prime} (0) = 1 - \Pf(\xi = 1) > 0 , \\
		& 1 - \psi_{\xi}^{\prime} (1) = 1 - \mu < 0 .
	\end{align*}
	Рассмотрим теперь $z - \psi_{\xi} (z)$ при $z = 0$.
	Поскольку $1 - \psi_{\xi} (1) = 0$, производная этой функции монотонно убывает,
	а $0 - \psi_{\xi} (0) = -\Pf(\xi = 0) < 0$,
	то график функции $z - \psi_{\xi} (z)$ пересечет ось абсцисс в двух точках,
	одна из которых будет лежать в интервале $(0, 1)$.
	Так как вероятность вырождения $\Pf(A)$ равна наименьшему корню уравнения \eqref{eq1},
	то $\Pf(A) < 1$, что и требовалось доказать.
\end{proof}

\begin{imp}
	Пусть $\Ef \xi < \bes$.
Тогда $\Ef Z_{n} = (\Ef \xi)^{n},\; n \in \N{.}$
\end{imp}

\begin{proof}
	Доказательство проводится по индукции.

	База индукции: $n=1 \Ra \Ef Z_{1} = \Ef \xi$.

	Индуктивный переход:
	\[
		\Ef Z_{n}
	=	\Ef \hr{ \sum_{k = 1}^{Z_{n - 1}} \xi_{n,k} }
	=	\sumjzi j \Ef \xi \Pf(Z_{n - 1} = j)
	=	\Ef \xi \Ef Z_{n - 1}
	=	\hr{\Ef \xi}^n.
	\]
\end{proof}

\begin{df}

	При $\Ef \xi < 1$ процесс называется \textit{докритическим.}

	При $\Ef \xi = 1$ процесс называется \textit{критическим.}

	При $\Ef \xi > 1$ процесс называется \textit{надкритическим.}
\end{df}

\section{Процессы восстановления}

\begin{df}\index{Процесс!восстановления}
	Пусть $S_n = X_1 \spl X_n$, где $n \in \N$, 
	$X, X_1, X_{2} \etc$ \td независимые одинаково распределенные случайные величины, $X \ge 0$.
	Положим
	\begin{align*}
		Z(0) &\deq 0;\\
		Z(t) &\deq \sup \hc{ n \in \N \mid S_n \le t }, \quad t > 0.
	\end{align*}
	(здесь считаем, что $\sup \varnothing \deq \bes$).
	Таким образом,
	\[
		Z(t, \omega) = \sup \hc{ n \in \N \mid S_n(\omega) \le t }.
	\]
	Иными словами,
	\[
		\hc{ Z(t) \ge n} = \hc{ S_n \le t}.
	\]
	Так определенный процесс $Z(t)$ называется \textit{процессом восстановления}.
\end{df}

\begin{note}
	Полезно заметить, что
	\[
		Z(t) = \sumnui \Ibb \hc{ S_n \le t},\quad t > 0.
	\]
\end{note}
\begin{df}
%FIXME
\phantomsection
\label{dfstar}
	Рассмотрим \textit{процесс восстановления} $\hc{ Z^\star(t),\; t \ge 0 }$,
	который строится по $Y, Y_{1}, Y_{2}\etc$ \td независимым одинаково распределенным случайным величинам,
	где $\Pf(Y = \alpha) = p \in (0, 1)$, $\Pf(Y = 0) = 1 - p$.
	Исключаем из рассмотрения случай, когда $Y = C = \const$:
		если $C = 0$, то $Z(t) = \bes \; \fA t > 0$;
		если же $C > 0$, то $Z(t) = \hs{\frac t c}$.
\end{df}

\begin{lemma}
	Для $l = 0, 1, 2\etc$
	\[
		\Pf(Z^{\star}(t) = m) =
		%FIXME?
		\bcase{
			C_m^j p^{\hs{\frac t \alpha} + 1} q^{m - \hs{\frac t \alpha}}, &\quad\text{если  $m \ge j$;} \\
			0,&\quad\text{если $m < j$.}
		}
	\]
\end{lemma}
